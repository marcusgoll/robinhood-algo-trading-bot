# Robinhood Trading Bot Configuration
# Constitution v1.0.0 - §Security: No credentials in code

# ============================================
# ROBINHOOD API CREDENTIALS
# ============================================
# Get these from your Robinhood account
# NOTE: These are ONLY required for LIVE trading mode.
# Paper trading does NOT require Robinhood credentials and will use simulated orders.
ROBINHOOD_USERNAME=your_username_here
ROBINHOOD_PASSWORD=your_password_here
ROBINHOOD_MFA_SECRET=  # Optional: MFA/2FA secret key (for pyotp)
DEVICE_TOKEN=  # Optional: Auto-populated after first successful authentication

# ============================================
# TRADING CONFIGURATION
# ============================================
# IMPORTANT: Always start with paper trading!
PAPER_TRADING=true  # Set to 'false' ONLY after thorough testing

# Risk Management (§Risk_Management)
MAX_POSITION_PCT=5.0  # Maximum % of portfolio per position
MAX_DAILY_LOSS_PCT=3.0  # Circuit breaker: max daily loss %
MAX_CONSECUTIVE_LOSSES=3  # Circuit breaker: max consecutive losses

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# ============================================
# PERFORMANCE TRACKING
# ============================================
# Rolling window size for alert evaluation (number of trades)
PERFORMANCE_ALERT_ROLLING_WINDOW=20

# Timezone for daily/weekly/monthly boundary calculations
PERFORMANCE_SUMMARY_TIMEZONE=UTC

# ============================================
# MOMENTUM DETECTION (Feature 002)
# ============================================
# News API for catalyst detection (optional - graceful degradation if missing)
NEWS_API_KEY=  # Get from https://newsapi.org/ or similar provider

# Market data provider selection
MARKET_DATA_SOURCE=alpaca  # Options: alpaca, yahoo, polygon (default: alpaca)

# Alpaca API credentials (for market data - free tier available)
ALPACA_API_KEY=  # Get from https://alpaca.markets/
ALPACA_SECRET_KEY=
ALPACA_BASE_URL=https://paper-api.alpaca.markets  # Use paper trading endpoint

# Momentum detection thresholds (defaults shown - override as needed)
MIN_CATALYST_STRENGTH=60.0  # Minimum strength score (0-100) for catalyst signals
MIN_PREMARKET_CHANGE_PCT=5.0  # Minimum pre-market price change % (default: 5%)
MIN_VOLUME_RATIO=200.0  # Minimum volume ratio % vs 10-day avg (default: 200%)
POLE_MIN_GAIN_PCT=8.0  # Minimum pole gain % for bull flag pattern (default: 8%)
FLAG_RANGE_PCT_MIN=3.0  # Minimum flag consolidation range % (default: 3%)
FLAG_RANGE_PCT_MAX=5.0  # Maximum flag consolidation range % (default: 5%)

# ============================================
# EMOTIONAL CONTROL (Feature 027)
# ============================================
# Automated position size reduction during significant losses or losing streaks
EMOTIONAL_CONTROL_ENABLED=true  # Enable/disable emotional control mechanisms

# ============================================
# ORDER FLOW MONITORING (Feature 028)
# ============================================
# Level 2 order book and Time & Sales monitoring for detecting institutional selling pressure

# Data source for order flow (Robinhood API does NOT support Level 2 data)
ORDER_FLOW_DATA_SOURCE=polygon  # Options: polygon (default and recommended)

# Polygon.io API key (required for order flow monitoring)
POLYGON_API_KEY=  # Get from https://polygon.io/ (Starter plan: $99/month)

# Alert thresholds (defaults shown - override as needed)
ORDER_FLOW_LARGE_ORDER_SIZE=10000  # Minimum shares for large seller alert (default: 10,000)
ORDER_FLOW_VOLUME_SPIKE_THRESHOLD=3.0  # Volume spike multiplier (default: 3.0x = 300%)
ORDER_FLOW_RED_BURST_THRESHOLD=4.0  # Critical volume spike for exit signal (default: 4.0x = 400%)
ORDER_FLOW_ALERT_WINDOW_SECONDS=120  # Time window for exit signal evaluation (default: 120s = 2 min)

# Monitoring scope
ORDER_FLOW_MONITORING_MODE=positions_only  # Options: positions_only (default), watchlist

# ============================================
# BOT API (Feature 029 - LLM-Friendly Operations)
# ============================================
# FastAPI service for LLM access to bot state and operations
BOT_API_PORT=8000  # API server port
BOT_API_AUTH_TOKEN=  # Generate a secure random token (e.g., `openssl rand -hex 32`)
BOT_API_BASE_URL=http://api:8000  # API base URL (use 'http://api:8000' for Docker, 'http://localhost:8000' for local)
BOT_API_CORS_ORIGINS=*  # Allowed CORS origins (* for development, specific domains for prod)
BOT_STATE_CACHE_TTL=60  # State cache TTL in seconds

# ============================================
# TELEGRAM NOTIFICATIONS (Feature 030)
# ============================================
# Real-time mobile notifications for trading events via Telegram Bot
TELEGRAM_ENABLED=false  # Enable/disable Telegram notifications (graceful degradation)
TELEGRAM_BOT_TOKEN=  # Get from @BotFather on Telegram
TELEGRAM_CHAT_ID=  # Your Telegram chat ID (use @userinfobot to find it)

# Notification preferences
TELEGRAM_NOTIFY_POSITIONS=true  # Notify on position entry/exit
TELEGRAM_NOTIFY_ALERTS=true  # Notify on risk alerts and circuit breakers
TELEGRAM_PARSE_MODE=Markdown  # Message format: Markdown, HTML, or None
TELEGRAM_INCLUDE_EMOJIS=true  # Include emoji in messages for better readability

# Rate limiting
TELEGRAM_ERROR_RATE_LIMIT_MINUTES=60  # Max 1 error notification per type per N minutes

# Quiet hours (suppress non-critical notifications during sleep)
TELEGRAM_QUIET_HOURS_START=22:00  # Start of quiet hours (HH:MM format, e.g., 22:00 = 10 PM)
TELEGRAM_QUIET_HOURS_END=06:00  # End of quiet hours (HH:MM format, e.g., 06:00 = 6 AM)
TELEGRAM_QUIET_HOURS_TIMEZONE=America/New_York  # Timezone for quiet hours
TELEGRAM_CRITICAL_BYPASS_QUIET=true  # Allow critical notifications (errors, circuit breakers) during quiet hours

# Notification deduplication
TELEGRAM_DUPLICATE_SUPPRESS_MINUTES=10  # Suppress duplicate messages within N minutes

# ============================================
# TELEGRAM COMMAND HANDLERS (Feature 031)
# ============================================
# Interactive command handlers for bot control and monitoring via Telegram
TELEGRAM_AUTHORIZED_USER_IDS=  # Comma-separated list of authorized Telegram user IDs (e.g., 123456789,987654321)
TELEGRAM_COMMAND_COOLDOWN_SECONDS=5  # Rate limit: minimum seconds between commands per user

# ============================================
# SENTIMENT ANALYSIS (Feature 034)
# ============================================
# Social media sentiment analysis integration using FinBERT model
SENTIMENT_ENABLED=true  # Enable/disable sentiment analysis (default: true)

# Twitter API v2 Credentials (for fetching tweets)
# Get from https://developer.twitter.com/en/portal/dashboard
TWITTER_API_KEY=  # Twitter API Key (OAuth 1.0a)
TWITTER_API_SECRET=  # Twitter API Secret
TWITTER_BEARER_TOKEN=  # Twitter Bearer Token (API v2)

# Reddit API Credentials (for fetching posts from r/wallstreetbets, r/stocks)
# Get from https://www.reddit.com/prefs/apps
REDDIT_CLIENT_ID=  # Reddit App Client ID
REDDIT_CLIENT_SECRET=  # Reddit App Client Secret
REDDIT_USER_AGENT=trading-bot:v1.0.0 (by /u/your_reddit_username)  # User agent string

# Sentiment Analysis Configuration
SENTIMENT_THRESHOLD=0.6  # Minimum sentiment score to trigger signal (0.0-1.0, default: 0.6)

# ============================================
# MULTI-AGENT TRADING SYSTEM (Feature 035)
# ============================================
# Self-learning multi-agent system with consensus voting for trading decisions
# Uses Claude API + Financial Modeling Prep for fundamental analysis

# Anthropic Claude API (Required for multi-agent system)
# Get from https://console.anthropic.com/
ANTHROPIC_API_KEY=  # Claude API key for LLM agent reasoning

# Financial Modeling Prep API (Free tier: 250 calls/day)
# Get from https://financialmodelingprep.com/developer/docs/
FMP_API_KEY=  # FMP API key for fundamental data (company metrics, ratios, news)

# PostgreSQL Database (Required for agent memory and self-learning)
# Format: postgresql://user:password@host:port/database
# Docker: postgresql://trading_bot:password@postgres:5432/trading_bot
# Local: postgresql://trading_bot:password@localhost:5432/trading_bot
DATABASE_URL=postgresql://trading_bot:password@postgres:5432/trading_bot
POSTGRES_PASSWORD=change_me_in_production  # PostgreSQL password (change in production!)

# Multi-Agent System Configuration
MULTI_AGENT_ENABLED=false  # Enable/disable multi-agent system (default: false)
MULTI_AGENT_MIN_AGREEMENT=2  # Minimum agents that must agree for BUY (default: 2/3 consensus)
MULTI_AGENT_DAILY_LLM_BUDGET=5.00  # Maximum daily LLM API spend in USD (default: $5.00)

# Self-Learning Loop Configuration
SELF_LEARNING_ENABLED=false  # Enable nightly self-learning cycles (default: false)
SELF_LEARNING_MIN_TRADES=10  # Minimum trades needed to run learning cycle (default: 10)
SELF_LEARNING_AUTO_APPLY_THRESHOLD=80.0  # Confidence threshold for auto-applying adjustments (default: 80%)
SELF_LEARNING_LOOKBACK_DAYS=30  # Days of history to analyze (default: 30)

# ============================================
# SECURITY NOTES
# ============================================
# 1. NEVER commit the actual .env file to git
# 2. Copy this file to .env and fill in your credentials
# 3. Ensure .env is in .gitignore
# 4. Use strong, unique passwords
# 5. Enable 2FA on your Robinhood account
